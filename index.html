<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random ASCII Art Viewer</title>
    <link rel="stylesheet" href="style.css">

    <style>
        .fit-container {
            display: inline-block;
            max-width: 100%;
            white-space: nowrap;
        }

        .fit-content {
            display: inline-block;
            max-width: 100%;
            white-space: nowrap;
            overflow: hidden;
        }

        .fit-container h3 {
            text-align: center;
        }

        .fit-content pre {
            margin-left: 2%;
            margin-right: 2%;
        }
    </style>
</head>

<body>

    <h1>Random ASCII Art Viewer</h1>

    <div class="fit-container" id="randomResult"></div>

    <script>
        // Load JSON file
        fetch('./ascii_results.json')
            .then(response => response.json())
            .then(data => {
                // Get a random result
                const randomIndex = Math.floor(Math.random() * data.results.length);
                const randomResult = data.results[randomIndex];

                // Display the result on the page
                const resultDiv = document.getElementById('randomResult');
                resultDiv.innerHTML = `
               <h3>Font: ${randomResult.font}</h3>
                </br>
                <div class="fit-content" id="fitContent">
                    <pre>${randomResult.ascii_art}</pre>
                </div>
            `;
            })
            .catch(error => console.error('Error fetching JSON:', error));
    </script>

    <script>
        // Adjust the font size of the ASCII art to fit the width of the container
        function adjustFontSize() {
            const fitContent = document.getElementById('fitContent');
            const containerWidth = fitContent.clientWidth;
            const textWidth = fitContent.scrollWidth;

            const scaleFactor = containerWidth / textWidth;
            const fontSize = 100 * scaleFactor + '%';

            fitContent.style.fontSize = fontSize;
        }

        // Call adjustFontSize() initially and whenever the window is resized pause for 100ms to avoid excessive calls
        window.addEventListener('resize', () => {
            adjustFontSize();
            clearTimeout(window.resizedFinished);
            window.resizedFinished = setTimeout(() => {
                adjustFontSize();
            }, 200);
        });
        // wait for the fetch to complete before calling adjustFontSize()
        window.addEventListener('load', () => {
            setTimeout(() => {
                adjustFontSize();
            }, 1000);
        });
    </script>

</body>
</html>